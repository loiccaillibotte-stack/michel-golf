<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>Calculateur Golf Pro - iPhone</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    html, body {
      -webkit-text-size-adjust: none;
      background: linear-gradient(135deg, #0f766e, #10b981);
      color: #111;
      overscroll-behavior: none;
    }

    .glass {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 1rem;
      padding: 1rem;
      box-shadow: 0 6px 16px rgba(0,0,0,0.1);
    }

    .golf-ball {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #fff, #e5e7eb);
      box-shadow: inset -4px -4px 10px rgba(0,0,0,0.1), 4px 4px 10px rgba(0,0,0,0.2);
    }

    .range-wrap {
      position: relative;
      width: 100%;
    }

    .range-value {
      position: absolute;
      top: -32px;
      left: 50%;
      transform: translateX(-50%);
      background: #059669;
      color: white;
      font-size: 13px;
      padding: 4px 8px;
      border-radius: 6px;
      white-space: nowrap;
      transition: left 0.1s linear;
    }

    input[type="range"] {
      -webkit-appearance: none;
      width: 100%;
      height: 20px;
      background: transparent;
      touch-action: none;
      margin-top: 10px;
    }

    input[type="range"]::-webkit-slider-runnable-track {
      height: 10px;
      border-radius: 10px;
      background: linear-gradient(90deg, #d1fae5, #10b981);
      box-shadow: inset 0 1px 2px rgba(0,0,0,0.2);
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #fff, #d1fae5);
      border: 3px solid #10b981;
      box-shadow: 0 3px 6px rgba(0,0,0,0.25);
      cursor: pointer;
      margin-top: -11px;
    }

    .precise-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 6px;
    }

    .precise-controls button {
      background: #10b981;
      color: white;
      border: none;
      font-weight: bold;
      font-size: 1.3rem;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      box-shadow: 0 3px 6px rgba(0,0,0,0.2);
      transition: transform 0.1s ease;
    }

    .precise-controls button:active {
      transform: scale(0.9);
      background: #059669;
    }

    .precise-display {
      font-size: 1rem;
      font-weight: bold;
      color: #065f46;
    }

    .stopwatch {
      text-align: center;
      padding: 1rem;
    }

    .stopwatch-display {
      font-size: 2rem;
      font-weight: bold;
      color: #059669;
      font-family: 'Courier New', monospace;
      margin: 0.5rem 0;
      text-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .stopwatch-buttons {
      display: flex;
      gap: 0.5rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .stopwatch-btn {
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 0.5rem;
      font-weight: bold;
      font-size: 0.875rem;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }

    .btn-start {
      background: #10b981;
      color: white;
    }

    .btn-start:active {
      transform: scale(0.95);
      background: #059669;
    }

    .btn-start:disabled {
      background: #9ca3af;
      cursor: not-allowed;
    }

    .btn-stop {
      background: #ef4444;
      color: white;
    }

    .btn-stop:active {
      transform: scale(0.95);
      background: #dc2626;
    }

    .btn-stop:disabled {
      background: #9ca3af;
      cursor: not-allowed;
    }

    .btn-reset {
      background: #6b7280;
      color: white;
    }

    .btn-reset:active {
      transform: scale(0.95);
      background: #4b5563;
    }

    .stopwatch-status {
      margin-top: 0.5rem;
      font-size: 0.875rem;
      color: #059669;
      font-weight: 600;
    }

    details {
      background: rgba(255, 255, 255, 0.6);
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255, 255, 255, 0.3);
      border-radius: 1rem;
      padding: 1rem;
      box-shadow: 0 6px 16px rgba(0,0,0,0.1);
    }

    summary {
      padding: 0.5rem;
      border-radius: 0.5rem;
      transition: background 0.2s;
    }

    summary:hover {
      background: rgba(16, 185, 129, 0.1);
    }
  </style>
</head>

<body class="p-4">
  <div class="max-w-3xl mx-auto space-y-6">

    <!-- En-t√™te -->
    <div class="glass flex items-center gap-3">
      <div class="golf-ball"></div>
      <div>
        <h1 class="text-2xl font-bold text-green-700">Calculateur Golf Pro</h1>
        <p class="text-sm text-gray-600">Version iPhone avec chronom√®tre int√©gr√©</p>
      </div>
    </div>

    <!-- Chronom√®tre -->
    <div class="glass">
      <div class="stopwatch">
        <label class="font-semibold text-gray-700 text-base">‚è±Ô∏è Chronom√®tre de vol</label>
        <div class="stopwatch-display" id="stopwatchDisplay">0.00</div>
        <div class="stopwatch-buttons">
          <button class="stopwatch-btn btn-start" id="startBtn" onclick="startStopwatch()">‚ñ∂ D√©marrer</button>
          <button class="stopwatch-btn btn-stop" id="stopBtn" onclick="stopStopwatch()" disabled>‚è∏ Arr√™ter</button>
          <button class="stopwatch-btn btn-reset" id="resetBtn" onclick="resetStopwatch()">‚Üª Reset</button>
        </div>
        <div class="stopwatch-status" id="stopwatchStatus"></div>
      </div>
    </div>

    <!-- Contr√¥les -->
    <div class="glass space-y-5">

      <!-- Dur√©e de vol -->
      <div>
        <label class="font-semibold text-gray-700">‚è±Ô∏è Dur√©e de vol (secondes)</label>
        <div class="range-wrap mt-2">
          <input type="range" id="flightTime" min="2" max="6" step="0.01" value="4.00">
          <div class="range-value" id="flightTimeValue">4.00 s</div>
        </div>
        <div class="precise-controls">
          <button onclick="adjustTime(-0.01)">‚àí</button>
          <div class="precise-display" id="flightDisplay">4.00 s</div>
          <button onclick="adjustTime(0.01)">+</button>
        </div>
      </div>

      <!-- Club -->
      <div>
        <label class="font-semibold text-gray-700">üèåÔ∏è S√©lection du club</label>
        <select id="clubSelector" class="border border-green-400 rounded-lg p-2 w-full">
          <option value="9" data-spin="2200">Driver (9¬∞)</option>
          <option value="10.5" data-spin="2400" selected>Driver (10.5¬∞)</option>
          <option value="12" data-spin="2600">Driver (12¬∞)</option>
          <option value="13" data-spin="3200">Bois 3 (13-15¬∞)</option>
          <option value="15" data-spin="3800">Bois 5 (15-18¬∞)</option>
          <option value="18" data-spin="4200">Hybride 3 (18-20¬∞)</option>
          <option value="20" data-spin="4500">Hybride 4 (20-22¬∞)</option>
          <option value="17" data-spin="4000">Fer 3 (17-20¬∞)</option>
          <option value="19" data-spin="4500">Fer 4 (19-22¬∞)</option>
          <option value="21" data-spin="5000">Fer 5 (21-24¬∞)</option>
          <option value="24" data-spin="5500">Fer 6 (24-27¬∞)</option>
          <option value="27" data-spin="6000">Fer 7 (27-31¬∞)</option>
          <option value="31" data-spin="6500">Fer 8 (31-35¬∞)</option>
          <option value="35" data-spin="7000">Fer 9 (35-40¬∞)</option>
          <option value="41" data-spin="7500">Pitching Wedge (41-46¬∞)</option>
          <option value="50" data-spin="8500">Gap Wedge (50-52¬∞)</option>
          <option value="54" data-spin="9000">Sand Wedge (54-56¬∞)</option>
          <option value="60" data-spin="10000">Lob Wedge (60¬∞)</option>
        </select>
        <div class="text-green-600 text-sm mt-1" id="launchAngleValue">10.5¬∞</div>
        <div class="text-sm text-gray-500" id="spinRateValue">Spin : 2400 rpm</div>
      </div>
    </div>

    <!-- R√©sultats principaux -->
    <div class="glass">
      <div class="text-center mb-4">
        <div class="text-sm text-gray-600">üéØ Distance empirique</div>
        <div class="text-4xl text-orange-600 font-bold" id="simplifiedDistance">0.0 m</div>
      </div>
      <div class="grid grid-cols-2 gap-3 text-center border-t pt-3">
        <div>
          <div class="text-xs text-gray-500">üí® Vitesse</div>
          <div class="text-xl text-green-700 font-bold" id="velocity">0.0 m/s</div>
          <div class="text-xs text-green-600" id="velocityKmh">0.0 km/h</div>
        </div>
        <div>
          <div class="text-xs text-gray-500">üìè Effet Magnus</div>
          <div class="text-xl text-emerald-600 font-bold" id="magnusDistance">0.0 m</div>
        </div>
      </div>
    </div>

    <!-- R√©sultats d√©taill√©s (repliable) -->
    <details class="glass">
      <summary class="cursor-pointer font-semibold text-gray-700 text-center">üìä D√©tails des calculs</summary>
      <div class="grid grid-cols-2 gap-3 text-center mt-3">
        <div>
          <div class="text-xs text-gray-600">Th√©orique</div>
          <div class="text-lg text-blue-600 font-bold" id="idealDistance">0.0 m</div>
        </div>
        <div>
          <div class="text-xs text-gray-600">Avec tra√Æn√©e</div>
          <div class="text-lg text-indigo-600 font-bold" id="dragDistance">0.0 m</div>
        </div>
      </div>
    </details>
  </div>

  <script>
    const g = 9.81;
    let stopwatchInterval = null;
    let startTime = 0;
    let elapsedTime = 0;
    let isRunning = false;

    function startStopwatch() {
      if (!isRunning) {
        isRunning = true;
        startTime = Date.now() - elapsedTime;
        stopwatchInterval = setInterval(updateStopwatch, 10);
        document.getElementById('startBtn').disabled = true;
        document.getElementById('stopBtn').disabled = false;
        document.getElementById('stopwatchStatus').textContent = 'üü¢ En cours...';
      }
    }

    function updateStopwatch() {
      elapsedTime = Date.now() - startTime;
      const seconds = (elapsedTime / 1000).toFixed(2);
      document.getElementById('stopwatchDisplay').textContent = seconds;
    }

    function stopStopwatch() {
      if (isRunning) {
        isRunning = false;
        clearInterval(stopwatchInterval);
        const finalTime = (elapsedTime / 1000).toFixed(2);
        
        // Mettre √† jour le slider avec le temps mesur√©
        const slider = document.getElementById('flightTime');
        const timeValue = parseFloat(finalTime);
        
        if (timeValue >= parseFloat(slider.min) && timeValue <= parseFloat(slider.max)) {
          slider.value = timeValue;
          updateResults();
          document.getElementById('stopwatchStatus').textContent = '‚úÖ Temps appliqu√© : ' + finalTime + ' s';
        } else {
          document.getElementById('stopwatchStatus').textContent = '‚ö†Ô∏è Temps hors limites (2-6s)';
        }
        
        document.getElementById('startBtn').disabled = false;
        document.getElementById('stopBtn').disabled = true;
        
        // R√©initialiser automatiquement apr√®s 1 seconde
        setTimeout(() => {
          resetStopwatch();
        }, 1000);
      }
    }

    function resetStopwatch() {
      clearInterval(stopwatchInterval);
      isRunning = false;
      elapsedTime = 0;
      document.getElementById('stopwatchDisplay').textContent = '0.00';
      document.getElementById('startBtn').disabled = false;
      document.getElementById('stopBtn').disabled = true;
      document.getElementById('stopwatchStatus').textContent = '';
    }

    function calculateDistance(spinRate) {
      const flightTime = parseFloat(document.getElementById('flightTime').value);
      const launchAngle = parseFloat(document.getElementById('clubSelector').value);
      const theta = launchAngle * Math.PI / 180;
      const v0_ideal = (g * flightTime) / (2 * Math.sin(theta));

      const dragFactor = 0.47;
      const airDensity = 1.225;
      const ballMass = 0.0459;
      const ballRadius = 0.0214;
      const crossSection = Math.PI * ballRadius ** 2;

      const dragCorrection = 1 - (dragFactor * airDensity * crossSection * v0_ideal) / (2 * ballMass * 10);
      const magnusLift = (spinRate / 3000) * 0.15;
      const magnusCorrection = 1 + magnusLift;

      const d_ideal = (v0_ideal ** 2 * Math.sin(2 * theta)) / g;
      const d_real = d_ideal * dragCorrection * magnusCorrection;
      const d_simplified = 0.65 * (g * flightTime ** 2) / (4 * Math.tan(theta)) * (1 + spinRate / 10000);

      return { ideal: d_ideal, withDrag: d_ideal * dragCorrection, withMagnus: d_real, simplified: d_simplified, v0: v0_ideal };
    }

    function updateResults() {
      const slider = document.getElementById('flightTime');
      const val = parseFloat(slider.value);
      const min = slider.min, max = slider.max;
      const percent = (val - min) / (max - min);

      document.getElementById('flightTimeValue').style.left = `calc(${percent * 100}% - 20px)`;
      document.getElementById('flightTimeValue').textContent = val.toFixed(2) + " s";
      document.getElementById('flightDisplay').textContent = val.toFixed(2) + " s";

      const clubSelect = document.getElementById('clubSelector');
      const launchAngle = parseFloat(clubSelect.value);
      const spinRate = parseFloat(clubSelect.options[clubSelect.selectedIndex].dataset.spin);

      document.getElementById('launchAngleValue').textContent = launchAngle.toFixed(1) + '¬∞';
      document.getElementById('spinRateValue').textContent = "Spin : " + spinRate + " rpm";

      const results = calculateDistance(spinRate);

      document.getElementById('idealDistance').textContent = results.ideal.toFixed(1) + ' m';
      document.getElementById('dragDistance').textContent = results.withDrag.toFixed(1) + ' m';
      document.getElementById('magnusDistance').textContent = results.withMagnus.toFixed(1) + ' m';
      document.getElementById('simplifiedDistance').textContent = results.simplified.toFixed(1) + ' m';
      document.getElementById('velocity').textContent = results.v0.toFixed(1) + ' m/s';
      document.getElementById('velocityKmh').textContent = (results.v0 * 3.6).toFixed(1) + ' km/h';
    }

    function adjustTime(step) {
      const slider = document.getElementById('flightTime');
      let val = parseFloat(slider.value) + step;
      val = Math.max(slider.min, Math.min(slider.max, val));
      slider.value = val.toFixed(2);
      updateResults();
    }

    document.getElementById('flightTime').addEventListener('input', updateResults);
    document.getElementById('clubSelector').addEventListener('change', updateResults);

    updateResults();
  </script>
</body>
</html>
